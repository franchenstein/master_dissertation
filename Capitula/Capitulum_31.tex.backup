\chapter{Geração de PRNG mediantes mapa caóticos}\label{cap:Geraçã de PRNG}


{\lettrine[loversize=0.25,findent=0.2em,nindent=0em]{N}{este} capítulo propomos técnicas para o projeto de RNG a partir de mapas caóticos e introduzimos técnicas de discretização codificada 
variante no tempo. Apesar dos métodos considerado serem independente do mapa caótico, empregamos para o estudo de caos o mapa tanh. Para testar a aleatoriedade das sequências geradas empregamos 
a entropia condicional e o teste NIST.

%%%%%%%%%%%%%%%%%%%%%% FIM DA SEÇÃO - INTRODUÇÃO %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%\section{Geração de PRNG caóticas}

%Existem varias técnicas adotadas para geração de sequências aleatórias a partir de mapas caóticos como são:
%\begin{itemize}
% \item Discretizacão \cite{micco.08}.
% \item Pular \cite{micco.08}.
% \item Retroalimentação \cite{Addabbo}.
%\end{itemize}

%Na tese se desenvolve a técnica de pular. Nesta técnica vai-se lidar com um processo de duas etapas:
%\begin{itemize}
% \item Particionar a serie de entrada $S_{IN}$, em grupos de comprimento $d$, sem superposição, considerando cada grupo como um ponto 
% num $d-$ dimensão, no espaço $E$.Agora cada ponto representa um vector de comprimento $d$.
% \item Tomamos para cada ponto $E$, um símbolo constituído por apenas uma coordenada(por exemplo o primeiro), gerando assim a série de tempo de saída $S_{OUT}$.
%\end{itemize}
%Note-se que os valores ($d-1$) da sinal de entrada são ignorados para obter o $S_{OUT}$, que origina o nome Pular, nesta técnica.
%Em outras palavras, podemos empregar, em vez do mapa original f, os seus tempos de d-iterado $f^d$. Para um entendimento melhor mostra-se a tabela.

%\begin{table}[]
%\centering
%\caption{My caption}
%\label{my-label}
%\begin{tabular}{|c|c|c|c|c|c|}
%\hline
%\multicolumn{6}{|c|}{Procedimento do Skipping}                                                                                                                         \\ \hline
%Sin         & \multicolumn{5}{c|}{Sout}}                                                                                                                                \\ \hline
%(R)         & d=2                          & d=3                          & d=4                          & d=5                          & d=6                          \\ \hline
%0.010559404 & \multirow{2}{*}{0.041791613} & \multirow{3}{*}{0.160180296} & \multirow{4}{*}{0.538090276} & \multirow{5}{*}{0.994196523} & \multirow{6}{*}{0.023079185} \\ \cline{1-1}
%0.041791613 &                              &                              &                              &                              &                              \\ \cline{1-2}
%0.160180296 & \multirow{2}{*}{0.538090276} &                              &                              &                              &                              \\ \cline{1-1} \cline{3-3}
%0.538090276 &                              & \multirow{3}{*}{0.023079185} &                              &                              &                              \\ \cline{1-2} \cline{4-4}
%0.994196523 & \multirow{2}{*}{0.023079185} &                              & \multirow{4}{*}{0.328210418} &                              &                              \\ \cline{1-1} \cline{5-5}
%0.023079185 &                              &                              &                              & \multirow{5}{*}{0.416446528} &                              \\ \cline{1-3} \cline{6-6} 
%0.090186145 & \multirow{2}{*}{0.328210418} & \multirow{3}{*}{0.881953358} &                              &                              & \multirow{6}{*}{0.108579760} \\ \cline{1-1}
%0.328210418 &                              &                              &                              &                              &                              \\ \cline{1-2} \cline{4-4}
%0.881953358 & \multirow{2}{*}{0.416446528} &                              & \multirow{4}{*}{0.108579760} &                              &                              \\ \cline{1-1} \cline{3-3}
%0.416446528 &                              & \multirow{3}{*}{0.108579760} &                              &                              &                              \\ \cline{1-2} \cline{5-5}
%0.972075269 & \multirow{2}{*}{0.108579760} &                              &                              & \multirow{5}{*}{0.193347257} &                              \\ \cline{1-1}
%0.108579760 &                              &                              &                              &                              &                              \\ \cline{1-4} \cline{6-6} 
%0.387160782 & \multirow{2}{*}{0.949069244} & \multirow{3}{*}{0.193347257} & \multirow{4}{*}{0.623856380} &                              & \multirow{4}{*}{}            \\ \cline{1-1}
%0.949069244 &                              &                              &                              &                              &                              \\ \cline{1-2}
%0.193347257 & \multirow{2}{*}{0.623856380} &                              &                              &                              &                              \\ \cline{1-1} \cline{3-3} \cline{5-5}
%0.623856380 &                              &                              &                              &                              &                              \\ \hline
%\end{tabular}
%\end{table}

%\rred{Como alternativa ao emprego de diferentes quantificadores para avaliar a distribuição invariante e a correlação de uma sequência discretizada, 
%a \underline{taxa de entropia} é capaz de refletir ambas essas características \cite{cover06}}. Como pode ser demonstrado, a \underline{taxa de entropia} 
%é uma função não crescente com o comprimento $n$ da sequência considerada, e quanto seu valor e assintoticamente próximo a um, a correspondente indicação de 
%aleatoriedade da sequência é consistente com a outros quantificadores \cite{berami13}.

%%%%%%%%%%%%%%%%%%%%%% FIM DA SEÇÃO - SECOES %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


%%%%%%%%%%%%%%%%%%%%%% INICIO DA SEÇÃO - Entropia condicional Familia Mapa Tanh %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Entropia Condicional}

A entropia condicional é uma medida importante para determinar a aleatoriedade de uma sequência 
binária~\cite{berami13}. Seja $\{ Z_n \}_{n=1}^{\infty}$ uma sequência de variáveis aleatórias binárias  estacionárias. 
Define-se a entropia condicional de $Z_n$ dado os ($n-1$) últimos símbolos $Z^{n-1}$ ($Z^{n-1} = Z_{n-1} Z_{n-2}\cdots Z_{1}$) da seguinte forma~\cite{cover06}
\[
H(Z_n \mid Z^{n-1}) = \sum_{z^n \in \{0,1\}^n} \Pr(z^n) \log_2 \left(\frac{1}{ \Pr(z_n \mid z^{n-1}) }\right)\! .
\] 
A entropia condicional $H(Z_n \mid Z^{n-1})$ é não crescente com $n$ para um processo estacionário e converge
para a taxa de entropia $H$~\cite{cover06}
\[
H = \lim_{n \rightarrow \infty} H(Z_n \mid Z^{n-1}). 
\]
Uma sequência aleatória ideal deve atingir  $H(Z_n \mid Z^{n-1})=1$ para todos os valores de $n$. Para gerar uma sequência binária $\{Z_n\}$ a partir da família de mapas tanh, procedemos 
da seguinte forma. Fixamos um valor de $r$ e uma condição inicial $x_0$ e obtermos uma órbita finita usando $x_n= f(x_n - 1),    n=1,2,...$. Os primeiros 400 pontos gerados são descartados 
devido ao transiente inicial da órbita. O intervalo $[-1,1]$ é particionado em duas regiões $\mathcal{R}_0=[-1,\varepsilon)$ e $\mathcal{R}_1=[\varepsilon,1]$ satisfazendo 
$\Pr(x_n\in \mathcal{R}_0)=\Pr(x_n\in \mathcal{R}_1)=1/2$, tal que se $x_n \in \mathcal{R}_0$ então $z_n = 0$, ou se $x_n \in \mathcal{R}_1$ ent\~ao  $z_n = 1$.

%A Fig.~\ref{fig:entropia} 
As seguintes Figuras \ref{fig:entropiar} e \ref{fig:entropiai} mostram $H(Z_n \mid Z^{n-1})$ versus $n$ para uma sequência binária gerada por simulação
para os mapas e-tanh e o-tanh, respectivamente, para diferentes valores do parâmetro $r$. Observa-se em todas as curvas mostradas que a entropia condicional decresce até um valor de $n$,
e após este valor converge para a taxa de entropia. Denomina-se de $n^{*}$ este valor limite de $n$ a partir do qual a entropia condicional permanece constante, e igual a $H$. Por exemplo, 
observamos na Figura \ref{fig:entropiar} que $n^{*} = 7$.

\begin{figure}[!t]
 \centering %
 \begin{pspicture}(-.6,-.4)(6.5,4) 
 \rput(3,2){\includegraphics[scale=0.7]{Figuras/entropiar}}
 \rput{0}(3.2,-.05){\small $n$}
 \rput{90}(-.5,2.1){\small $H(Z_n/Z^{n-1})$}
 \end{pspicture}
 \caption{\label{fig:entropiar} $H(Z_n \mid Z^{n-1})$ versus $n$ para mapa e-tanh para $r=3,4,5$.}
\end{figure}

\begin{figure}[!t]
 \centering %
 \begin{pspicture}(-.6,-.4)(6.5,4)
 \rput(3,2){\includegraphics[scale=0.7]{Figuras/entropiai}}
 \rput{0}(3.2,-.05){\small $n$}
 \rput{90}(-.5,2.1){\small $H(Z_n/Z^{n-1})$}
 \end{pspicture}
 \caption{\label{fig:entropiai} $H(Z_n \mid Z^{n-1})$ versus $n$ para mapa o-tanh para $r=3,4,5$.}
\end{figure}

%A Figura~\ref{fig:entropiar} mostra o comportamento do mapa e-tanh. A entropia condicional decresce até um valor aproximado de $n= 7$. 
Observe-se nas curvas da Figura~\ref{fig:entropiar} o valor da taxa de entropia tem valores $H=0,867$ para $r=3$, $H=0,94$ para $r=4$ e $H=0,917$ para $r=5$. 
A incerteza sobre uma variável $Z_n$ decresce com o conhecimento de valores passados até $n=7$, 
o que implica a presença de uma memória finita na sequência binária. Não espera-se uma correlação relevante 
entre as variáveis $Z_n$ e $Z_{n+m}$ para $m > 7$, para todos os valores de $r$ considerados. 

As curvas da Figura~\ref{fig:entropiai} mostram que a entropia condicional do mapa o-tanh decresce até $n^{*} = 5$ para $r=3$ e $4$ e para $r=5$ $n^{*}$ é 6. 
Os valores da taxa de entropia neste caso são $H=0,937$ para $r=3$, $H=0,971$ para $r=4$ e $H=0,950$ para $r=5$.

%Na Tabela \ref{tab:valn} mostra-se os diferentes valores de $n^{*}$ da família de mapas tanh quando variamos os parâmetros $r$ e $b$. Pode-se observar que o maior valor de $n^{*}$ para os mapas 
%e-tanh e o-tanh são $n^{*} = 7$ e $n^{*} = 6$, respectivamente.

%\begin{table}[!h]
%\centering
%\caption{Valores de $n^{*}$ para diferentes valores de $r$ com CFT}
%\label{tab:valn}
%\begin{tabular}{|l|l|l|l|}
%\hline
%\multicolumn{2}{|l|}{MAPA E-TANH} & \multicolumn{2}{l|}{MAPA O-TANH} \\ \hline
%$r$               & $n^{*}$              & $r$              & $n^{*}$              \\ \hline
%2               & 7               & 2              & 4               \\ \hline
%3               & 7               & 3              & 5               \\ \hline
%4               & 7               & 4              & 5               \\ \hline
%5               & 7               & 5              & 5               \\ \hline
%6               & 7               & 6              & 6               \\ \hline
%7               & 6               & 7              & 6               \\ \hline
%\end{tabular}
%\end{table}

%Pode-se aplicar um pós-processamento na sequência binária para torná-la uma RNG. A taxa deste processamento (medida pela razão dos \textit{bits} de saída pelos \textit{bits} de entrada, em média) deve ser menor ou igual a $H$ \cite[Teorema 1]{berami13}. Portanto, a taxa \textit{bits} (após o pós-processamento) por amostra da sequência caótica é menor que 1. Na próxima seção, proporemos uma técnica de discretização codificada variante no tempo que atinge taxa unitária e é aprovada nos testes de aleatoriadade considerados neste trabalho. 

%A Figura 2 \ref{fig:entropia} mostra uma das características importante das sequências binárias geradas por o mapa o-stanh, a perda de memoria do mapa depois de um determinado valor $n$, que coincide com a taxa de entropia $H_f$. Quando  $n$ vai aumentando as sequências binárias v\~ao perdendo a memoria, e depois de $n=6$ para o maa em estudo, a entropia condicional fica quase-constante, o 
%seja perdeu a correla\c{c}\~ao entre \textit{bits}.\\
%Na pr\'oxima se\c{c}\~ao estudaremos como melhorar a entropia condicional do mapa em estudo e a aleatoriedade, para isso \'e necessário implementar 
%um bloco de post-processamento na sequ\^encia binária. 

A próxima seção descreve o procedimento de geração de um RNG proposto nesta dissertação, utilizando a família de mapas tanh. 

\section{Geração de um RNG Baseado na família Mapa tanh} 

A geração de um RNG é composta de três etapas: geração de uma órbita finita a partir de um mapa
caótico, emprego da técnica de saltos de amostras~\cite{micco.08} para reduzir a correlação da sequência caótica
e, finalmente, a sequência binária é gerada usando a técnica de discretização codificada(fixa no tempo ou variante no tempo). Como se mostra no diagrama de blocos da Figura ~\ref{fig:blocos1}.
\begin{figure}[b!]
 \begin{pspicture}(-.6,-.4)(6.5,4)
 \psframe(1,1)(4,2)
 \rput{0}(2.5,1.5){\small Mapa tanh}
 \psline{->}(4,1.5)(5,1.5)
 \psframe(5,1)(8,2)
 \rput{0}(6.5,1.75){\small Salto de}
 \rput{0}(6.5,1.25){\small Amostras}
 \psline{->}(8,1.5)(9.3,1.5)
 \psframe(9.3,1)(12.3,2)
 \rput{0}(10.8,1.75){\small Codificação}
 \rput{0}(10.8,1.25){\small CFT ou CVT}
 \psline{->}(12.3,1.5)(13.6,1.5)
 \rput{0}(4.5,1.7){\small $X_k$}
 \rput{0}(8.6,1.7){\small $Z_k ... Z_{kq}$}
 \rput{0}(12.9,1.7){\small $Y_k ... Y_{qk}$}
 \end{pspicture}
 \caption{\label{fig:blocos1} Diagrama de bloco do esquema da geração de RNG.}
\end{figure}




%Motivado pelo comportamento da entropia condicional mostrado na seção anterior, inicialmente reduz-se a correlação da sequência caótica pelo emprego da técnica de saltos de amostras proposta em~\cite{micco.08}.
%o primeiro passo para geração de um RGN é o emprego da técnica de saltos de amostras proposta em~\cite{micco.08}.

O salto de amostras tem como entrada uma órbita finita gerada pelo mapa $\{x_k\}_{k=1}^{N}$ e produz na
saída $\{x^\prime_{k}\}_{k=1}^{N^\prime} = \{ x_{k \cdot p}\}_{k=1}^{N^\prime}$, para um valor fixo do parâmetro $p$ que especifica o salto de amostras. 
%A sequência de saída tem comprimento $p$ vezes menor que o comprimento da sequência de entrada.
Se for aplicado o procedimento usual de mapear a sequência de saída em uma partição com duas regiões (conforme discutido na seção anterior), 
a sequência binária também tem comprimento $p$ vezes menor a sequência caótica de entrada, o que compromete a taxa de \textit{bits} por amostra caótica, gerada na saída do codificador.

Para aumentar esta taxa, propomos particionar o intervalo $[-1,1]$ em $2^q$ regiões, $\mathcal{R}_i$, $i=0,\cdots {2^q}-1$,   
de tal forma que $\Pr(x_k\in \mathcal{R}_i)= 1/2^q$. Por exemplo, para o mapa e-tanh com $r=3$, as quatro regiões 
(para $q=2$) são [-1,-0.65), [-0.65,0.19), [0.19,0.87), [0.87,1]. Para o mapa o-tanh estas regiões são, [-1, -0.77), [-0.77, 0), [0, 0.77), [0.77, 1). 
Esta partição reflete a concentração do histograma em valores extremos do mapa, como mostrado nas Figuras \ref{fig:Fig18} e \ref{fig:Fig19}. Para o mapa o-tanh mostra que as
duas regiões dos extremos e as duas regiões internas são iguais. Enquanto o mapa e-tanh não apresenta o mesmo comportamento, devido a acumulação de mais pontos em uma extremidade que na 
outra. Cada região $R_i$ é rotulada com uma sequência binária de $q$ \textit{bits}. O emprego do salto de amostras em conjunto com a discretização de $2^q$ regiões produz uma 
taxa de \textit{bits} por amostra caótica, denotado de $R_x$, da seguinte forma:

\begin{equation}
R_x= q/p.
\end{equation}

Por exemplo, para $R_x =1$ a sequência binária é a sequência caótica têm o mesmo comprimento, ou seja, gera-se a mesma quantidade de \textit{bits} por amostras que os saltos dados. 
Por outro lado, o particionamento em duas regiões implica que $R_x=1/p$. 

O processo de codificação consiste em atribuir a cada região uma sequência de \textit{bits} (denominada de sequência código). Por exemplo, uma codificação fixa das regiões, denominada de CFT,  
para $q=2$ é $(00, 01, 10, 11)$. Por exemplo, se $x^{\prime}_k \in \mathcal{R}_0$ então a sequência binária gerada neste intervalo é 00, se $x^{\prime}_k \in \mathcal{R}_1$ a sequência gerada é 01, 
e assim sucessivamente. O emprego de $q>1$ propicia o surgimento de uma correlação entre os \textit{bits} das sequências código de cada região, o que enfraquece a aleatoriedade da sequência 
binária gerada.

Este comportamento é observado nas curvas de entropia condicional mostradas nas Figuras~\ref{fig:graf1} e ~\ref{fig:graf2}. Nestas curvas, fixa-se os parâmetros do $r =3$ e $p=1$ (sem saltos ]
de amostras), e considera-se três valores de $q$. Observe-se que a taxa de entropia decresce e o valor de $n^{*}$ cresce com o aumento de $q$ para os mapas e-tanh (Figura~\ref{fig:graf1}) 
e o-tanh (Figura~\ref{fig:graf2}) 

\begin{figure}[!t]
 \centering %
 \begin{pspicture}(-.6,-.4)(6.5,4) 
 \rput(3,2){\includegraphics[scale=0.7]{Figuras/graf1}}
 \rput{0}(3.2,-.05){\small $n$}
 \rput{90}(-.5,2.1){\small $H(Z_n/Z^{n-1})$}
 \end{pspicture}
 \caption{\label{fig:graf1} $H(Z_n \mid Z^{n-1})$ versus $n$ para mapa e-tanh para $r=3$, $p=1$ e $q=1,2,3$, com CFT.}
\end{figure}

%\begin{figure}[!h]
%\centering
% \includegraphics[scale=0.5]{Figuras/gra.eps}
% \caption{}\label{fig:graf1}
%\end{figure}

\begin{figure}[!t]
 \centering %
 \begin{pspicture}(-.6,-.4)(6.5,4) 
 \rput(3,2){\includegraphics[scale=0.7]{Figuras/graf2}}
 \rput{0}(3.2,-.05){\small $n$}
 \rput{90}(-.5,2.1){\small $H(Z_n/Z^{n-1})$}
 \end{pspicture}
 \caption{\label{fig:graf2} $H(Z_n \mid Z^{n-1})$ versus $n$ para mapa o-tanh para $r=3$, $p=1$ e $q=1,2,3$, com CFT.}
\end{figure}

%\begin{figure}[!h]
%\centering
% \includegraphics[scale=0.5]{Figuras/graf2.eps}
% \caption{}\label{fig:graf2}
%\end{figure}

Na Figuras ~\ref{fig:graf1} e Figura ~\ref{fig:graf2} se observa o comportamento esperado, a codificação CFT introduz uma correlação a mais na sequência binária de saída. 
Para diminuir o efeito desta correlação propor-se uma codificação variante no tempo , denominada de CVT, que consiste em um deslocamento cíclico para 
direita entre os \textit{bits} que rotulam regiões adjacentes. Por exemplo, 
se para a $n$-ésima amostra caótica a codificação é $(00, 01, 10, 11)$, para a próxima amostra a codificação passa a ser $(10, 00, 11,01)$. As curvas de entropia condicional utilizando a CVT 
são mostradas nas Figuras~\ref{fig:CVTpar} e \ref{fig:CVTimpar}. Se utilizam os mesmos valores de $r$ das Figuras~\ref{fig:entropiar} e ~\ref{fig:entropiai}, e parâmetros de $p=1$ e $q=1$.

\begin{figure}[!t]
 \centering %
 \begin{pspicture}(-.6,-.4)(6.5,4) 
 \rput(3,2){\includegraphics[scale=0.7]{Figuras/CVTpar}}
 \rput{0}(3.2,-.05){\small $n$}
 \rput{90}(-.5,2.1){\small $H(Z_n/Z^{n-1})$}
 \end{pspicture}
 \caption{\label{fig:CVTpar} $H(Z_n \mid Z^{n-1})$ versus $n$ para mapa e-tanh para $r=3,4,5$, com CVT.}
\end{figure}

\begin{figure}[!t]
 \centering %
 \begin{pspicture}(-.6,-.4)(6.5,4) 
 \rput(3,2){\includegraphics[scale=0.7]{Figuras/CVTimpar}}
 \rput{0}(3.2,-.05){\small $n$}
 \rput{90}(-.5,2.1){\small $H(Z_n/Z^{n-1})$}
 \end{pspicture}
 \caption{\label{fig:CVTimpar} $H(Z_n \mid Z^{n-1})$ versus $n$ para mapa o-tanh para $r=3,4,5$, com CVT.}
\end{figure}

%Na Tabela \ref{tab:valni} mostra-se os diferentes valores de $n^{*}$ da família de mapas tanh quando variamos os parâmetros $r$ e $b$ e utilizamos a codificação CVT. 
%O maior valor de $n^{*}$ para os mapas e-tanh e o-tanh são $n^{*} = 6$ e $n^{*} = 6$, respectivamente. Como pode-se observar o valor de $n^{*}$ diminui com respeito a codificação CFT, em diferentes
%calores do parâmetro $r$. 

%\begin{table}[!h]
%\centering
%\caption{Valores de $n^{*}$ para diferentes valores de $r$ com CVT}
%\label{tab:valni}
%\begin{tabular}{|l|l|l|l|}
%\hline
%\multicolumn{2}{|l|}{MAPA E-TANH} & \multicolumn{2}{l|}{MAPA O-TANH} \\ \hline
%$r$               & $n^{*}$              & $r$              & $n^{*}$              \\ \hline
%2               & 6               & 2              & 4               \\ \hline
%3               & 6               & 3              & 4               \\ \hline
%4               & 6               & 4              & 5               \\ \hline
%5               & 5               & 5              & 5               \\ \hline
%6               & 6               & 6              & 6               \\ \hline
%7               & 6               & 7              & 6               \\ \hline
%\end{tabular}
%\end{table}
%\begin{figure}[!h]
%\centering
% \includegraphics[scale=0.5]{Figuras/graf3.eps}
% \caption{Diferentes valores de \textit{bits} gerados por amostra no mapa e-tanh com CVT}\label{fig:graf3}
%\end{figure}

%\begin{figure}[!h]
%\centering
% \includegraphics[scale=0.5]{Figuras/graf4.eps}
% \caption{Diferentes valores de \textit{bits} gerados por amostra no mapa o-tanh com CVT}\label{fig:graf4}
%\end{figure}


%Como se pode ser visto nas Figuras~\ref{fig:CVTpar} 
%e Figura~\ref{fig:CVTimpar}. O efeito da correlação introduzida mediante o bloco de codificação utilizando este método de codificar é menor a utilizando a CFT, mas ainda introduz 
%correlação a mais como se mostra nas Figuras~\ref{fig:graf3} e ~\ref{fig:graf4}.

%\begin{figure}[!t]
% \centering %
% \begin{pspicture}(-.6,-.4)(6.5,4) 
% \rput(3,2){\includegraphics[scale=0.7]{Figuras/graf3}}
% \rput{0}(3.2,-.05){\small $n$}
% \rput{90}(-.5,2.1){\small $H(Z_n)/H(Z^{n-1})$}
 %\end{pspicture}
% \caption{\label{fig:graf3} $H(Z_n \mid Z^{n-1})$ versus $n$ para mapa e-tanh para $r=3$, $p=1$ e $q=1,2,3$, com CVT.}
%\end{figure}

%\begin{figure}[!t]
% \centering %
% \begin{pspicture}(-.6,-.4)(6.5,4) 
% \rput(3,2){\includegraphics[scale=0.7]{Figuras/graf4}}
% \rput{0}(3.2,-.05){\small $n$}
 %\rput{90}(-.5,2.1){\small $H(Z_n)/H(Z^{n-1})$}
 %\end{pspicture}
 %\caption{\label{fig:graf4} $H(Z_n \mid Z^{n-1})$ versus $n$ para mapa o-tanh para $r=3$, $p=1$ e $q=1,2,3$, com CVT..}
%\end{figure}

Esta codificação apresenta um aumento de taxa de entropia. O valor de $n^{*}$ para o mapa e-tanh (Figura~\ref{fig:CVTpar}) é igual a 6, e na Figura~\ref{fig:CVTimpar} note-se que $n^{*}=4$ para 
$r=3$, e $n^{*}=5$ para $r=4, 5$. Por exemplo, comparando-se as Figuras~\ref{fig:entropiai} e \ref{fig:CVTimpar} para $r=3$, pode-se observar que o valor de $n^{*}$ é menor utilizando a 
codificação CVT. Na Tabela~\ref{tab:n} se faz um resumo dos valores de $n^{*}$ para os diferentes valores de $r$ utilizados. Também obtemos uma taxa de entropia melhor para CVT $R_x = 0,9423$ 
que para CFT ($R_x = 0,8756$). 
%A Tabela~\ref{tab:comp} faz-se uma comparação da taxa de entropia dos dois 
%métodos utilizados para três valores de $q$, sem o emprego de saltos de amostras $p=1$ e para $r=3$.

\begin{table}[]
\centering
\caption{Valores de $n^{*}$ para os mapas e-tanh e o-tanh com $r = 3, 4, 5$.}
\label{tab:n}
\begin{tabular}{|c|c|c|c|}
\hline
\multicolumn{2}{|c|}{}                  & mapa e-tanh      & mapa o-tanh     \\ \hline
\multirow{2}{*}{$r$=3}        & CFT       & 7                & 5               \\ \cline{2-4} 
                            & CVT       & 6                & 4               \\ \hline
\multirow{2}{*}{$r$=4}        & CFT       & 7                & 5               \\ \cline{2-4} 
                            & CVT       & 6                & 5               \\ \hline
\multirow{2}{*}{$r$=5}        & CFT       & 7                & 6               \\ \cline{2-4} 
                            & CVT       & 6                & 5               \\ \hline
\end{tabular}
\end{table}

%\begin{table}[]
%\centering
%\caption{Comparação da taxa de entropia para as codificações CFT e CVT, para $r=3$.}
%\label{tab:comp}
%\begin{tabular}{|l|l|l|l|}
%\hline
%\multicolumn{1}{|c|}{\multirow{2}{*}{\begin{tabular}[c]{@{}c@{}}Taxa de\\ Bits\end{tabular}}} & \multicolumn{1}{c|}{\multirow{2}{*}{\begin{tabular}[c]{@{}c@{}}Simetria do\\ Mapa\end{tabular}}} & \multicolumn{1}{c|}{CFT}                 & \multicolumn{1}{c|}{CVT}                 \\ \cline{3-4} 
%\multicolumn{1}{|c|}{}                                                                           & \multicolumn{1}{c|}{}                                                                               & \multicolumn{1}{c|}{Taxa de Entropia ($H$)} & \multicolumn{1}{c|}{Taxa de Entropia ($H$)} \\ \hline
%\multirow{2}{*}{$q=1$}                                                                       & e-tanh                                                                                              & 0.8756                                   & 0.9423                                   \\ \cline{2-4} 
%                                                                                                 & o-tanh                                                                                              & 0.9966                                   & 0.9977                                   \\ \hline
%\multirow{2}{*}{$q=2$}                                                                        & e-tanh                                                                                              & 0.                                   & 0.9423                                   \\ \cline{2-4} 
%                                                                                                 & o-tanh                                                                                              & 0.9715                                   & 0.9878                                   \\ \hline
%\multirow{2}{*}{$q=3$}                                                                        & e-tanh                                                                                              & 0.6385                                   & 0.8535                                   \\ \cline{2-4} 
%                                                                                                 & o-tanh                                                                                              & 0.7999                                   & 0.8247                                   \\ \hline
%\end{tabular}
%\end{table}

A seguir, empregaremos a bateria de testes NIST para analisar a aleatoriedade de sequências binárias geradas com o procedimento proposto nesta seção. 
Para cada valor de $r$, discutiremos valores apropriados de $p$ e $q$ que quando associados às técnicas CFT e CVT produzem RNG's com maior taxa $R_x$.
 
\section{Teste de Aleatoriedade NIST}

Para concluir se uma estratégia de geração um RNG é criptograficamente segura, as sequências geradas devem ser submetidas a uma variedade de testes estatísticos projetados 
para detectar características específicas esperadas de sequências aleatórias. Existem várias opções disponíveis de testes estatísticos, entre as quais destacamos: 
NIST~\cite{nist}, DIEHARD~\cite{56}, testes de  Knuth~\cite{knuth.81}. 

Neste trabalho empregaremos o NIST (versão 800-22) que é um pacote que compreende 15 testes estatísticos baseado em teste de hipóteses e é largamente usado na literatura. No Apêndice A, apresenta-se
uma breve explicação dos testes estatísticos realizados no NIST.
%Existem várias opções disponíveis de testes estatísticos para análise de aleatoriedade de sequências binárias, entre as quais destacamos: NIST~\cite{nist}, DIEHARD~\cite{56}, 
%testes de  Knuth~\cite{knuth.81}.

%Este conjunto de testes
%assume as seguintes propriedades para as sequências binárias aleatórias que vão ser testadas \cite{nist}:
%\begin{itemize}
% \item \textbf{Uniformidade}: A qualquer ponto na geração de uma sequência de \textit{bits} aleatórios ou pseudo-aleatórios, a ocorrência de um $0$ ou $1$ é equiprovável, ou seja, a probabilidade 
% é exatamente 1/2 para cada um. O número esperado de zeros (ou uns) é $n/2$, em que $n$ é o comprimento da sequência.
% \item \textbf{Escalabilidade}: Qualquer teste aplicável a uma sequência também pode ser aplicado a subsequências extraídas ao azar da sequência. Se uma sequência é aleatória, extraindo-se
% qualquer subsequência dela, esta também deve ser aleatória. Portanto, qualquer subsequência deve passar pelo teste de aleatoriedade.
% \item \textbf{Consistência}: É insuficiente para provar um PRNG com base na saída de uma única semente, ou gerador de números aleatórios com base na potência produzida a partir de uma 
% única saída física.
%\end{itemize}

Cada teste é utilizado para determinar a aceitação ou rejeição da hipótese que detecta um desvio da aleatoriedade ideal e gera um parâmetro $P$-$value$ que indica a probabilidade 
de um gerador de números aleatórios ideal produzir uma sequência menos aleatória que a sequência testada. Este é calculado com nível de significância $\alpha$, tipicamente compreendido 
no intervalo [0,001;0,01]. Se $P$-$value$ é igual a 1, então a sequência parece ter aleatoriedade perfeita, enquanto $P$-$value$ igual a 0 indica que a sequência parece ser completamente 
não-aleatória (para um dado teste). Para o valor adotado, $\alpha = 0,01$, uma sequência é aprovada com nível de significância de $99\%$. 

%Em seguida, foram analisados os resultados do gerador proposto usando a bateria padrão do NIST.
Nas simulações realizadas, a sequência binária de entrada do NIST tem comprimento $524 288 000$ (formada pela concatenação de 500 subsequências de comprimento 1048576 
geradas com condições iniciais escolhidas aleatoriamente). 
O teste fornece como resultado o valor de $P$-$value$ bem como a razão de subsequências aprovadas para cada teste da bateria NIST. A razão mínima para que a 
sequência passe em cada teste é calculada usando o procedimento mostrado em~\cite{nist} que depende do número de subsequências e do valor de 
$\alpha$. Para os valores considerados, esta é 0,9767. Portanto, se $P$-$value$ é maior que $\alpha$ e a razão é maior que  0,9767 então a sequência é considerada 
aprovada em um teste, caso contrário, a sequência é rejeitada.

A Tabela~\ref{tab:taxas} apresenta as maiores taxas $R_x$ alcançadas, com codificação CFT e CVT, que passaram no teste NIST para cada valor do salto $p$ 
para o mapa e-tanh para três valores de $r$. A Tabela \ref{tab:taxa} apresenta a mesma análise para o-tanh.
Nestas tabelas, o símbolo X indica que o gerador não passa no teste para os parâmetros indicados, enquanto o símbolo ``--'' indica que não é possível aumentar a 
taxa em relação à mostrada na mesma coluna para um valor menor de $p$. O emprego de CVT permite aumentar substancialmente a taxa, como por exemplo é observado na Tabela \ref{tab:taxas}. 
Para $r=3$ e $p=7$ no mapa e-tanh, obtemos uma taxa de \textit{bits} $R_x=1/7$ que é obtida com a codificação CFT. Utilizando a codificação variante no tempo (CVT) obtêm-se uma taxa $R_x=7/7$.
O gerador não passa no teste para $p=7$ e codificação fixa quando utilizamos o parâmetro $r=4$ e $r=5$. O aumento do salto 
para $p=8$ ou $p=9$ ainda permite obter um bom gerador com codificação fixa para $q>1$, embora com taxa de \textit{bits} é baixa. Observa-se que é possível obter um gerador com taxa menor que 1 que passe nos 
testes com $p=6$ e CVT. O esquema CVT atinge a maior taxa (unitária) com $p=7$ para os valores de $r=3$ e $r=4$, para $r=5$ não chega-se obter a taxa de \textit{bits} unitária. O aumento da taxa 
propiciado pela codificação CVT tambem é observado na Tabela~\ref{tab:taxa}

\begin{table}
\caption{\label{tab:taxas} Maiores taxas $R_x$ alcançadas com CFT e CVT, para o mapa e-tanh com $r=3,4,5$.}
\centering %
\begin{tabular}{|c|c|c|c|c|c|c|}
\hline
 \multirow{2}{*}{Salto} & \multicolumn{2}{c|}{$r=3$} & \multicolumn{2}{c|}{$r=4$} & \multicolumn{2}{c|}{$r=5$} \\ \cline{2-7} 
                       & CVT            & CFT     & CVT           & CFT      & CVT         & CFT     \\ \hline
$p=6 $                   & 5/6       & X        & 5/6      & X         & 4/6   & X           \\ \hline
$p=7$                    & 7/7       & 1/7      & 7/7      & X         & 5/7   & X           \\ \hline
$p=8 $                   & --        & 2/8      & --       & 1/8       & --    & X           \\ \hline
$p=9$                    & --        & 3/9      & --       & --       &  --   & 1/9         \\ \hline
\end{tabular}
\end{table}

\begin{table}
\caption{\label{tab:taxa} Maiores taxas $R_x$ alcançadas com CFT e CVT, para o mapa o-tanh com $r=3,4,5$.}
\centering %
\begin{tabular}{|c|c|c|c|c|c|c|}
\hline
 \multirow{2}{*}{Salto} & \multicolumn{2}{c|}{$r=3$} & \multicolumn{2}{c|}{$r=4$} & \multicolumn{2}{c|}{$r=5$} \\ \cline{2-7} 
                       & CVT            & CFT     & CVT           & CFT      & CVT         & CFT     \\ \hline
$p=3 $                   & 1/3       & X        & 1/3      & X         & 1/3   & X           \\ \hline
$p=4$                    & 4/4       & X        & 4/4      & X         & 3/4   & X           \\ \hline
$p=5 $                   & --        & 1/5      & --       &1/5       & --    & X           \\ \hline
$p=6$                    & --        & 5/6      & --       & 4/6       &  --   & 2/6         \\ \hline
\end{tabular}
\end{table}

Como se pode observar o mapa o-tanh perde a correlação mais rápido que o mapa e-tanh. A taxa $R_x$ unitária é atingida com um valor de saltos menor para o mapa o-tanh ($p=4$) que para 
o mapa e-tanh ($p=7$) para o mesmo valor de $r=3$ e utilizando a CVT. A Tabela \ref{tab:entc} ilustra que a taxa de entropia deve ter um valor muito elevado para que a sequência binaria
passe em todos os testes NIST.

\begin{table}[]
\centering
\caption{Taxa de Entropia para codificação CFT.}
\label{tab:entc}
\begin{tabular}{|c|c|c|c|}
\hline
Mapa.                                                                      & \begin{tabular}[c]{@{}c@{}}Parâmetros\\ (q e p)\end{tabular} & \begin{tabular}[c]{@{}c@{}}Entropia \\ Condicional\end{tabular} & Resultado   \\ \hline
\multirow{3}{*}{\begin{tabular}[c]{@{}c@{}}Mapa e-tanh\\ CFT\end{tabular}} & $q = 1$  $p = 5$                                                  & $H$= 0,9997                                                       & Não Sucesso \\ \cline{2-4} 
                                                                           & $q = 1$  $p = 6$                                                  & $H$= 0,9997                                                       & Não Sucesso \\ \cline{2-4} 
                                                                           & $q = 1$  $p = 7$                                                  & $H$= 0,9999                                                       & Sucesso     \\ \hline
\multirow{3}{*}{\begin{tabular}[c]{@{}c@{}}Mapa o-tanh\\ CFT\end{tabular}} & $q = 1$  $p = 3$                                                  & $H$= 0,9990                                                       & Não Sucesso \\ \cline{2-4} 
                                                                           & $q = 1$  $p = 4$                                                  & $H$= 0,9995                                                       & Não Sucesso \\ \cline{2-4} 
                                                                           & $q = 1$  $p = 5$                                                  & $H$= 0,9999                                                       & Sucesso     \\ \hline
\end{tabular}
\end{table}

Apresentam-se nas Tabelas \ref{tab-nist1}, \ref{tab-nist2}, \ref{tab-nist3} e \ref{tab-nist4} os resultados dos testes NIST realizados para as sequências geradas pela  
família de mapas tanh. Fixamos o parâmetro $r=3$ e mostramos as melhores taxas encontradas para as duas codificações. Este gerador passa em todos os testes realizados, portanto é um RNG de alta
qualidade de acordo com o teste NIST. Convém ressaltar que a taxa de entropia para estas sequências é maior que $H=0,9999$ para todos os casos sendo um indicador adicional da aleatoriedade 
da sequência binária gerada. 

\begin{table}[!h]
\caption{\label{tab-nist1} $P$-$value$ e a razão de testes aprovados para cada teste do NIST, para o mapa 
e-tanh com $r=3$, $R_x=7/7$, com CVT.}
\centering
\begin{tabular}{|l|c|c|c|}
\hline
Teste Estatístico     & $P$-${value}$   & Aprovados   & Resultado          \\ \hline
Frequency               & 0,353733      & 0,98800 & Sucesso \\ \hline
Block Frequency          & 0,041169      & 0,98600 & Sucesso \\ \hline
Runs                    & 0,911413      & 0,98800 & Sucesso \\ \hline
Longest-Run-of-Ones              & 0,448424      & 0,99600 & Sucesso \\ \hline
Binary Matrix Rank                    & 0,021407      & 0,99600 & Sucesso \\ \hline
FFT                     & 0,197981      & 0,98200 & Sucesso \\ \hline
Non-Overlapping Template & 0,603841      & 0,99400 & Sucesso \\ \hline
Overlapping Template    & 0,682823      & 0,99000 & Sucesso \\ \hline
Universal               & 0,150340      & 0,99200 & Sucesso \\ \hline
Linear Complexity        & 0,463512      & 0,98400 & Sucesso \\ \hline
Serial                  & 0,649612      & 0,98800 & Sucesso \\ \hline
Approximate Entropy     & 0,073201      & 0,98800 & Sucesso \\ \hline
Random Excursions       & 0,023545      & 0,98214 & Sucesso \\ \hline
Random Excursions Variant       & 0,122325      & 0,98276 & Sucesso \\ \hline
Cumulative Sums         & 0,767582      & 0,99600 & Sucesso \\ \hline
\end{tabular}
\end{table}



Convém ressaltar que $n^{*}=7$ e $n^{*}=5$ é o valor do salto indicado pela entropia condicional mostrada nas Figuras~\ref{fig:entropiar} e \ref{fig:entropiai}, para a quebra da 
correlação das sequências binárias geradas pelos mapas e-tanh e o-tanh, respectivamente, com $q=1$ e valores de $r$ entre 3 e 5. Portanto, a informação gerada pela entropia condicional é 
importante para a determinação do valor do salto de amostras $p$.

%%%%%%%%%%%%%%%%%%%%%% FIM DA SEÇÃO -  %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{Geração de PRNG com pós-processamento usando \\sequências-m}

Nas seções anteriores, empregamos a técnica de saltos de amostras para eliminar a correlação entre as amostras caóticas. Com esta técnica o valor máximo alcançado por $R_x$ é igual a 1 (com CVT). 
Nesta seção, não empregamos salto de amostras (portanto, adotamos nesta seção $p = 1$) e este correlação é eliminada por um pós-processamento na saída da codificação baseada por uma sequência 
gerada por um LFSR. O foco desta seção é o projeto do comprimento do LFSR. Algumas propriedades destas sequências são descritas na próxima subseção.

O esquema para a geração de um PRNG considerado nesta seção tem três blocos, conforme é mostrado na Figura \ref{fig:22}. Considerando uma codificação de $q$ bits, cada variável $X_n$ é mapeado em 
uma sequência código $Z_{(k-1)q + 1} Z_{(k-1)q+2} ... Z_{kq}$. Por exemplo, para $q=4$, $X_1$ é mapeado em $\{Z_1 Z_2 Z_3 Z_4\}$, $X_2$ é mapeado em $\{Z_5 Z_6 Z_7 Z_8\}$ e assim sucessivamente. 
Cada sequência de símbolos na saída do codificador é mapeada na saída da unidade de pós-processamento com o mesmo comprimento, portanto, esta unidade tem taxa unitária. A taxa deste sistema em 
\textit{bits} por amostras caótica é $R_x = q$. A sequência $\{Y_k\}$ é a entrada da bateria de teste NIST.

\begin{figure}[h!]
  \begin{pspicture}(-.6,-.4)(6.5,4)
 \psline{->}(4,1.5)(5,1.5)
 \psframe(1,1)(4,2)
 \rput{0}(2.5,1.5){\small Mapa tanh}
 \psframe(5,1)(8,2)
 \rput{0}(6.5,1.75){\small Codificação}
 \rput{0}(6.5,1.25){\small CFT ou CVT}
 \psline{->}(8,1.5)(9.2,1.5)
 \psframe(9.2,1)(12.2,2) 
 \rput{0}(10.7,1.5){\small Pós-processamento}
 \psline{->}(12.2,1.5)(13.2,1.5) 
 \rput{0}(4.5,1.7){\small $\{X_k\}$}
 \rput{0}(8.6,1.7){\small $\{Z_k\}$}
 \rput{0}(12.7,1.7){\small $\{Y_k\}$}
 \end{pspicture}
 \caption{\label{fig:22} Diagrama de blocos para geração de um PRNG.}
\end{figure}

\subsection{Sequências-m}

Uma sequência $\{W_k\}$ é gerada por um LFSR de $N$ comprimento se satisfaz a seguinte relação:
\begin{equation}
 W_k = c_1 W_{k-1} \oplus c_2 W_{k-2} \oplus ... \oplus c_{N-1} W_{k-(N -1)} \oplus W_{k-N}
\end{equation}
em que $c_i \in  \{0,1\}$ e $\oplus$ denota soma modulo dois. A conexão de realimentação do LFSR pode ser representada por um polinômio de realimentação
\begin{equation}
 p(x) = 1 + c_1 x + c_2 x^{N-2} + ... + c_{N-1}x^{N-1} + x^N.
\end{equation}
O polinômio de realimentação define o período e o comportamento estatístico da sequência $\{W_k\}$. Para garantir o maior período 
possível $2^N-1$ desta sequência, o polinômio $p(x)$ deve ser primitivo. A sequência gerada por um LFSR com um polinômio primitivo é chamada 
sequência de comprimento máximo, ou simplesmente de sequência-m. Os polinômios primitivos usados nesta dissertação são apresentados na Tabela~\ref{tab:prim}.

\begin{table}[t!]
\centering
\caption{Exemplos de polinômios primitivos de grau até 50}
\label{tab:prim}
\begin{tabular}{|l|l|l|l|l|}
\hline
(1, 0)                                          & (11, 2, 0)                                       & (21, 2, 0)                                       & (31, 3, 0)                                      & (41, 3, 0)                                            \\ \hline
(2, 1, 0)                                       & (12, 6, 4, 1, 0)                                 & (22, 1, 0)                                       & (32, 7, 6, 2, 0)                                & (42, 5, 4, 3, 2, 1, 0)                                \\ \hline
(3, 1, 0)                                       & (13, 4, 3, 1, 0)                                 & (23, 5, 0)                                       & (33, 13, 0)                                     & (43, 6, 4, 3, 0)                                      \\ \hline
(4, 1, 0)                                       & (14, 5, 3, 1, 0)                                 & (24, 4, 3, 1, 0)                                 & (34, 8, 4, 3, 0)                                & (44, 6, 5, 2, 0)                                      \\ \hline
(5, 2, 0)                                       & (15, 1, 0)                                       & (25, 3, 0)                                       & (35, 2, 0)                                      & (45, 4, 3, 1, 0)                                      \\ \hline
(6, 1, 0)                                       & (16, 5, 3, 2, 0)                                 & (26, 6, 2, 1, 0)                                 & (36, 11, 0)                                     & (46, 8, 5, 3, 2, 1, 0)                                \\ \hline
(7, 1, 0)                                       & (17, 3, 0)                                       & (27, 5, 2, 1, 0)                                 & (37, 6, 4, 1, 0)                                & (47, 5, 0)                                            \\ \hline
(8, 4, 3, 2, 0)                                 & (18, 7, 0)                                       & (28, 3, 0)                                       & (38, 6, 5, 1, 0)                                & (48, 7, 5, 4, 2, 1, 0)                                \\ \hline
(9, 4, 0)                                       & (19, 5, 2, 1, 0)                                 & (29, 2, 0)                                       & (39, 4, 0)                                      & (49, 9, 0)                                            \\ \hline
(10, 3, 0)                                      & (20, 3, 0)                                       & (30, 6, 4, 1, 0)                                 & (40, 5, 4, 3, 0)                                & (50, 4, 3, 2, 0)                                      \\ \hline
\multicolumn{5}{|c|}{\begin{tabular}[c]{@{}c@{}} Notação: $(50, 4, 3, 2, 0) \Rightarrow p(x)= x^{50} + x^4 + x^3 + x^2 + 1$  \end{tabular}} \\ \hline
\end{tabular}
\end{table}

As sequências-m geradas por polinômios de realimentação de grau $N$ apresentam uma entropia condicional $H(W_n/W^{n-1})$ aproximadamente igual a um para valores de $n$ até $N$, 
enquanto $n > N$ tende a zero devido a repetição dos valores das subsequência de comprimento maior que $N$, como ilustra a Figura \ref{fig:LFSREnt}. 
Idealmente todas as subsequências de comprimento $n \leq N$, acontecem com a probabilidade de $\frac{1}{2^N}$, apresentado uma característica local ideal. Esta característica 
da sequência-m é utilizada para eliminar a memória existente nas sequências binárias obtidas da família de mapas tanh.

\begin{figure}[!t]
 \centering %
 \begin{pspicture}(-.6,-.4)(6.5,4) 
 \rput(3,2){\includegraphics[scale=0.7]{Figuras/LFSREnt.eps}}
 \rput{0}(3.2,-.05){\small $n$}
 \rput{90}(-.5,2.1){\small $H(W_n/W^{n-1})$}
 \end{pspicture}
 \caption{\label{fig:LFSREnt} $H(W_n \mid W^{n-1})$ versus $n$ para sequências-m com $N = 5$ e $N=6$.}
\end{figure}

\subsection{Esquema de geração de PRNG com pós-processamento}

Para aproveitar as boas propriedades estatísticas das sequências-m propomos nesta subseção um método para gerar um PRNG que é uma combinação da técnica de discretização codificada variante 
no tempo de um mapa caótico com pós-processamento com uma sequência-m. Inicialmente obtém-se uma sequência binária a partir da discretização de um mapa caótico (usando um dos métodos, CFT ou CVT) 
e realiza-se uma soma módulo 2 desta com uma sequência-m gerada por um LFSR. Este método é ilustrado na Figura \ref{fig:bloco2}. Seja $\{Z_k\}$ a sequência na saída de um codificador CFT ou CVT 
e $\{W_k\}$ a sequência-m gerada pelo o LFSR, então a $k$-amostra de saída $\{Y_k\}$ é dada por:
\begin{equation}
 Y_k = Z_k \oplus W_k.
\end{equation}
Suponha que a sequência $\{Z_k\}$ é formada com $q=1$ (dois níveis de quantização) e é independente de $\{W_k\}$. Suponha ainda que estas sequências satisfazem as seguintes condições:

\begin{figure}[t!]
  \begin{pspicture}(-.6,-.4)(6.5,4)
 \psline{->}(4,1.5)(5,1.5)
 \psframe(1,1)(4,2)
 \rput{0}(2.5,1.5){\small Mapa tanh}
 \psframe(5,1)(8,2)
 \rput{0}(6.5,1.75){\small Codificação}
 \rput{0}(6.5,1.25){\small CFT ou CVT}
 \psline{->}(8,1.5)(9.2,1.5)
 \pscircle(9.35,1.5){0.15}
 \psline(9.35,1.65)(9.35,1.35)
 \psline(9.2,1.5)(9.7,1.5)
 \psline{->}(9.6,1.5)(10.6,1.5)
 \psline{->}(9.35,0.35)(9.35,1.35)
 \psframe(8.35,-0.15)(10.35,0.35)
 \rput{0}(9.35,0.1){\small LFSR}
 \rput{0}(4.5,1.7){\small $\{X_k\}$}
 \rput{0}(8.6,1.7){\small $\{Z_k\}$}
 \rput{0}(10.25,1.7){\small $\{Y_k\}$}
 \end{pspicture}
 \caption{\label{fig:bloco2} Diagrama de blocos do esquema da geração de um PRNG usando sequências-m.}
\end{figure}

%A sequência $\{W_k\}$ é uma sequência binária gerada por um LFSR de $N$ estágios e $\{Z_k\}$ é a sequência binária na saída de um codificador CFT ou CVT com $q=1$ (dois neveis de quantificação). 
 

\begin{itemize}
 \item A sequência $\{W_k\}$ tem características local ideal, isto é, para $n \leq N$:
 \begin{equation}
  \Pr(w_1 ... w_n) = \Pr (W_1 = w_1, ..., W_n = w_n) = \frac{1}{2^n}.
 \end{equation}
 \item Cada variável aleatória $Z_k$ tem distribuições uniforme, $\Pr (Z_k = 0) = \Pr (Z_k = 0) = \frac{1}{2}$, e duas variáveis aleatórias $Z_k$ e $Z_{k+n}$ são estatisticamente independentes 
 para $ n \geq N$, ou seja:
 \begin{equation}
  \Pr(z_k z_{k+m}) = \Pr(z_k) \cdot \Pr(z_{k+n}) = \frac{1}{4}  
 \end{equation}
\end{itemize}
Provaremos a seguir que se as condições (3.5) e (3.6) são satisfeitas, a sequência $\{Y_k\}$ é formada por variáveis aleatórias independentes e identicamente distribuídas com distribuição uniforme. 
Observe-se que a condição (3.6) implica que o valor de $N$ deve ser escolhido de tal forma que seja maior ou igual a memória existente na sequência $\{Z_k\}$ que é devida à memória existente 
na sequência $\{X_k\}$.

Para $n \leq N$, a probabilidade conjunta de $n$ variáveis aleatórias é dada por:

\begin{eqnarray}
 \Pr(y_1 ... y_n) &=& \sum_{w_1...w_n} \Pr(y_1...y_n | w_1 ... w_n) \cdot \Pr(w_1...w_n) \\
 &=& \sum_{w_1...w_n} \Pr(Z_1=y_1 \oplus w_1, ..., Z_n=y_n \oplus w_n) \cdot \Pr(w_1...w_n) \\
 &=& \frac{1}{2^n} \sum_{w_1...w_n} \Pr(Z_1=y_1 \oplus w_1, ..., Z_n=y_n \oplus w_n) \\
 &=& \frac{1}{2^n}
\end{eqnarray}
em que (3.8) segue da independência entre $\{Z_k\}$ e $\{W_k\}$ e (3.9) segue de (3.5). Considere agora que $n\geq N$:
\begin{eqnarray}
 \Pr(y_1 y_{k+n}) \! &=& \hspace{-0.5cm} \sum_{w_k w_{k+n}} \Pr(y_k y_{k+n} | w_k,w_{k+n}) \cdot \Pr(w_k w_{k+n}) \\
 \!&=& \hspace{-0.5cm} \sum_{w_k,w_{k+n}} \Pr(Z_k = y_k \oplus w_k, Z_{k+n} = y_{k+n} \oplus w_{k+n}) \cdot \Pr(w_k w_{k+n}) \\
 \!&=& \hspace{-0.5cm} \sum_{w_k,w_{k+n}} \Pr(Z_k = y_k \oplus w_k) \cdot \Pr(Z_{k+n}= y_{k+n}\oplus w_{k+n}) \cdot \Pr(w_k w_{k+n})\\
 \!&=& \! (\frac{1}{2})^2 \sum_{w_k,w_{k+n}} \cdot \Pr(w_k w_{k+n})
\end{eqnarray}
em que (3.13) e (3.14) segue de (3.6).
Observa-se que a variável aleatória $Y_k$ é independente de todas as variáveis em instantes passados $\{Y_\ell\}_{\ell=1}^{k-1}$, para todo $k$, visto que a independência para 
$\ell=k-1, ..., k-(N-1)$, segue de (3.10) e para $\ell < k-N$ segue de (3.14). Por tanto para $n > N$:
\begin{eqnarray}
 \Pr(y_1 ... y_n) &=& \Pr(y_n | y^{n-1}) \cdot \Pr(y_{n-1} | y^{n-2}) \cdot \cdot \cdot \Pr(y_{N+1} | y^{N}) \cdot \Pr(y_1  y^{N}) \\ 
 &=& \Pr(y_n) \cdot \Pr(y_{n-1}) \cdot \cdot \cdot \Pr(y_{N+1}) \cdot \frac{1}{2^N}\\
 &=& \frac{1}{2^{n-N}} \cdot \frac{1}{2^N} \\
 &=& \frac{1}{2^n}
\end{eqnarray}
o que em conjunto com (3.10) conclui a prova que $\{Y_n\}$ é uma sequência aleatória. Uma consequência das equações (3.5) e (3.6) é que:
\begin{equation}
 H(Y_k | Y^{k-1}) = 1
\end{equation}
para todo $k$.
As Figuras~\ref{fig:LFSR1} e ~\ref{fig:LFSR2} apresentam a entropia condicional da sequência $\{Y_k\}$ para os mapas e-tanh e o-tanh, respectivamente, para $r = 3$, $q = 1$, codificação CFT, 
para LFSR de comprimentos $N = 4,6,7$ (e-tanh) e $N= 2,4,5$ (o-tanh). Observa-se nestas figuras que o valor de $H$ é menor que 0.9999 para valores menores de $n^{*}$ (igual a 7 para o mapa e-tanh 
e igual a 5 para o mapa o-tanh) o que é um indicador que a sequência binaria gerada com $N < n^{*}$ não é aleatória (vimos na seção anterior que a aprovação no teste NIST requer uma taxa de entropia 
de ordem de 0.9999). Assim é necessário um polinômio de grau $N$ igual a $n^{*}$ para gerar uma sequência binária aleatória com $R_x=1$.  


%o efeito que tem a soma módulo dois da sequência binária caótica e a sequência-m. Fixa-se para 
%ambos mapas (e-tanh e o-tanh) o valor de $r = 3$, e eliminamos a etapa do emprego da técnica de saltos de amostras ($p = 1$), técnica que levou a uma diminuição da taxa de \textit{bits}. 
%Na Figura~\ref{fig:LFSR1} observa-se o gráfico de entropia condicional da soma modulo dois do mapa e-tanh e sequências-m utilizando $N = 4, 6, 7$ como grau dos polinômios. 
%Os parâmetros utilizados para a geração da sequência binária caótica $\{z_k'\}$ forem $q=1$, $p=1$ e com CFT. Na Figura~\ref{fig:LFSR2} mostra o gráfico de entropia condicional para o mapa o-tanh, 
%com os mesmos parâmetros anteriormente utilizados na figura anterior e $N = 2, 4, 5$.

\begin{figure}[!h]
 \centering %
 \begin{pspicture}(-.6,-.4)(6.5,4) 
 \rput(3,2){\includegraphics[scale=0.7]{Figuras/LFSR1}}
 \rput{0}(3.2,-.05){\small $n$}
 \rput{90}(-.5,2.1){\small $H(Y_n/Y^{n-1})$}
 \end{pspicture}
 \caption{\label{fig:LFSR1} $H(Y_n \mid Y^{n-1})$ versus $n$ do mapa e-tanh com $r=3$, $q=1$ e CFT para $N = 4, 6, 7$.}
\end{figure}

\begin{figure}[!h]
 \centering %
 \begin{pspicture}(-.6,-.4)(6.5,4) 
 \rput(3,2){\includegraphics[scale=0.7]{Figuras/LFSR2}}
 \rput{0}(3.2,-.05){\small $n$}
 \rput{90}(-.5,2.1){\small $H(Y_n /Y^{n-1})$}
 \end{pspicture}
 \caption{\label{fig:LFSR2} $H(Y_n \mid Y^{n-1})$ versus $n$ do mapa o-tanh com $r=3$, $q=1$ e CFT para $N = 2, 4, 6$.}
\end{figure}

O aumento do nível de discretização ($q > 1$) conduz a uma taxa de \textit{bits} $R_x =q$, mas introduz um aumento na correlação da sequência $\{Y_k\}$ devido à correlação existente
nas sequências códigos que rotulam cada amostra caótica. Propomos, então, um valor estimado $\hat{N}$ do grau do polinômio $N$ do LFSR para gerar uma sequência $\{Y_k\}$ com boas 
propriedades de aleatoriedade da seguinte forma:
\begin{equation}
 \hat{N} = n^{*} \cdot q.
\end{equation}
Seja $N_{min}$ o menor valor do grau do polinômio $N$ para que a sequência $\{Y_k\}$ passe no teste NIST. As Tabelas ~\ref{tab:LM1} e ~\ref{tab:LM2} comparam 
os valores de $\hat{N}$ e $N_{min}$ para diferentes taxas $R_x = q$ para os mapas e-tanh e o-tanh com $r=3$ e as duas formas de codificação CFT e CVT. Observamos nestas tabelas 
que $N_{min}$ cresce aproximadamente linearmente com $q$ sendo bem aproximado por $\hat{N}$ (uma discrepância entre $N_{min}$ e $\hat{N}$ de no máximo igual a 3 é observada nesta tabela) .


%Observa-se nas Figuras~\ref{fig:LFSR1} e ~\ref{fig:LFSR2} que o valor de $H$ para valores de $N$ menor que o valor de $n^{*}$ fica sempre menor que $H = 0.9999$, o que é um indicador 
%que a sequência binária gerada no processo não é aleatória. Assim, é necessário um polinômio de grau $N$  igual a $n^{*}$ para gerar uma sequência binária aleatória com $R_x =1$. 
%Quando se quer obter taxas de \textit{bits} maiores que um ($q > 1$), introduz-se uma correlação a mais na sequência $\{z'_{k}\}$ como foi demostrado anteriormente, e o valor esperado de $\bar{N}$ para a geração 
%de sequências-m deve ser:



%Como foi apresentado na Tabela~\ref{tab:n} vemos os valores em que cada mapa perde a memoria para o valor de $r=3$:
%\begin{itemize}
% \item Mapa e-tanh com CFT obtemos $n^{*}=7$
% \item Mapa e-tanh com CVT obtemos $n^{*}=6$
% \item Mapa o-tanh com CFT obtemos $n^{*}=5$
% \item Mapa o-tanh com CVT obtemos $n^{*}=4$
%\end{itemize}
 

%\begin{figure}[!h]
%\centering
% \includegraphics[scale=0.5]{Figuras/LFSR1.eps}
% \caption{}\label{fig:LFSR1}
%\end{figure}

%\begin{figure}[!h]
%\centering
% \includegraphics[scale=0.5]{Figuras/LFSR2.eps}
% \caption{Soma modulo dois do mapa o-tanh e LFSR com $p_{LFSR} = 6$}\label{fig:LFSR2}
%\end{figure}

%As Tabelas (~\ref{tab:LM1}, ~\ref{tab:LM2}, ~\ref{tab:LM3}, ~\ref{tab:LM4}) mostra o valor esperado ($\bar{N}$) do grau do polinômio e valor 
%mínimo de $N$ no qual a sequência $\{y_k\}$ passa nos teste do NIST. Nelas apresenta-se os resultados obtidos para obter diferentes taxas 
%$R_x = \frac{q}{p}$ para os mapas e-tanh e o-tanh, com $r = 3$, e as duas formas de codificação antes explicadas.

\begin{table}[h!]
\centering
\caption{Comparação entre $N_{min}$ e $\hat{N}$ para o mapa e-tanh com $r=3$ e codificação CFT ($n^{*}=7$) e CVT ($n^{*}=6$)}.
\label{tab:LM1}
\begin{tabular}{|c|c|c|c|c|}
\hline
        & \multicolumn{2}{c|}{CFT} & \multicolumn{2}{c|}{CVT} \\ \hline
$R_x=q$ & $N_{min}$       & $\hat{N}$      & $N_{min}$       & $\hat{N}$      \\ \hline
1       & 7               & 7              & 6               & 6              \\ \hline
2       & 13              & 14             & 9              & 12             \\ \hline
3       & 18              & 21             & 9              & 18             \\ \hline
4       & 26              & 28             & 10             & 24             \\ \hline
5       & 34              & 35             & 10             & 30             \\ \hline
6       & 40              & 42             & 11             & 36             \\ \hline
7       & 47              & 49             & 10             & 42             \\ \hline
\end{tabular}
\end{table}

\begin{table}[h!]
\centering
\caption{Comparação entre $N_{min}$ e $\hat{N}$ para o mapa o-tanh com $r=3$, e codificação CFT ($n^{*}=5$) e CVT ($n^{*}=4$)}.
\label{tab:LM2}
\begin{tabular}{|c|c|c|c|c|}
\hline
        & \multicolumn{2}{c|}{CFT} & \multicolumn{2}{c|}{CVT} \\ \hline
$R_x=q$ & $N_{min}$       & $\hat{N}$      & $N_{min}$       & $\hat{N}$      \\ \hline
1       & 5               & 5              & 5               & 4              \\ \hline
2       & 10              & 10             & 8               & 8              \\ \hline
3       & 12              & 15             & 11              & 12             \\ \hline
4       & 17              & 20             & 10              & 16             \\ \hline
5       & 22              & 25             & 9               & 20             \\ \hline
6       & 27              & 30             & 10              & 24             \\ \hline
7       & 33              & 35             & 10              & 28             \\ \hline
\end{tabular}
\end{table}

Pode-se ver que com o aumento do valor de $N$ pode-se gerar taxas maiores, que no entanto, os requerimentos de memória do LFSR cresce linearmente com a taxa de \textit{bits}. As Figuras 
\ref{fig:nvsqp} e \ref{fig:nvsqi} mostram este comportamento. Uma unidade de pós-processamento com menor requerimento de memória será proposta no próximo capítulo.

\begin{figure}[!h]
 \centering %
 \begin{pspicture}(-.6,-.4)(6.5,4) 
 \rput(3,2){\includegraphics[scale=0.7]{Figuras/nvsqp}}
 \rput{0}(3.2,-.05){\small $q$}
 \rput{90}(-.5,2.1){\small $\hat{N}$ e $N_{min}$}
 \end{pspicture}
 \caption{\label{fig:nvsqp} Comparação $N_{min}$ e $\hat{N}$ versus $q$ do mapa o-tanh com $r=3$.}
\end{figure}

\begin{figure}[!h]
 \centering %
 \begin{pspicture}(-.6,-.4)(6.5,4) 
 \rput(3,2){\includegraphics[scale=0.7]{Figuras/nvsqi}}
 \rput{0}(3.2,-.05){\small $q$}
 \rput{90}(-.5,2.1){\small $\hat{N}$ e $N_{min}$}
 \end{pspicture}
 \caption{\label{fig:nvsqi} Comparação $N_{min}$ e $\hat{N}$ versus $q$ do mapa e-tanh com $r=3$.}
\end{figure}


%%%%%%%%%%%%%%%%%%%%%% FIM DA SEÇÃO - FIM DO CAPÍTULO %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

